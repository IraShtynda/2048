(()=>{"use strict";var e={824:(e,t,r)=>{var a=r(963),o=r(252);const s={id:"app"};function i(e,t,r,a,i,n){const c=(0,o.up)("Game");return(0,o.wg)(),(0,o.iD)("div",s,[(0,o.Wm)(c)])}var n=r(577);const c={class:"game"},l={key:0,class:"game-message"};function u(e,t,r,a,s,i){const u=(0,o.up)("HeadBoard"),d=(0,o.up)("Board");return(0,o.wg)(),(0,o.iD)("div",c,[(0,o.Wm)(u,{onClickButton:i.clickButton,gameStatus:s.gameStatus,score:s.gameService.totalScore,bestScore:s.gameService.bestScore},null,8,["onClickButton","gameStatus","score","bestScore"]),(0,o.Wm)(d,{board:s.board},null,8,["board"]),s.message?((0,o.wg)(),(0,o.iD)("p",l,(0,n.zw)(s.message),1)):(0,o.kq)("",!0)])}const d=e=>((0,o.dD)("data-v-6b817d9c"),e=e(),(0,o.Cn)(),e),h={class:"head-board"},g=d((()=>(0,o._)("h1",{class:"title"},"2048",-1))),m={class:"head-board-right"},v={class:"scores"};function p(e,t,r,a,s,i){const c=(0,o.up)("Score");return(0,o.wg)(),(0,o.iD)("div",h,[g,(0,o._)("div",m,[(0,o._)("div",v,[(0,o.Wm)(c,{title:"SCORE",score:r.score},null,8,["score"]),(0,o.Wm)(c,{title:"BEST",score:r.bestScore},null,8,["score"])]),(0,o._)("div",{class:"button",onClick:t[0]||(t[0]=(...e)=>i.handleClick&&i.handleClick(...e)),style:(0,n.j5)(i.buttonStyle)},(0,n.zw)(i.buttonText),5)])])}const b={class:"score-wrapper"},S={key:0,class:"score-title"},f={class:"score"};function w(e,t,r,a,s,i){return(0,o.wg)(),(0,o.iD)("div",b,[r.title?((0,o.wg)(),(0,o.iD)("div",S,(0,n.zw)(r.title),1)):(0,o.kq)("",!0),(0,o._)("div",f,(0,n.zw)(r.score),1)])}const y={props:{title:{type:String,default:""},score:{type:Number,default:0}}};var k=r(744);const T=(0,k.Z)(y,[["render",w],["__scopeId","data-v-6f68ce18"]]),B=T,D={props:{score:{type:Number,default:0},bestScore:{type:Number,default:0},gameStatus:{type:String,default:""}},computed:{buttonText(){return"notStarted"===this.gameStatus?"Start":"playing"===this.gameStatus?"Restart":""},buttonStyle(){return{"background-color":"notStarted"===this.gameStatus?"#29D7A4":"#FF0024"}}},components:{Score:B},methods:{handleClick(){this.$emit("clickButton")}}},R=(0,k.Z)(D,[["render",p],["__scopeId","data-v-6b817d9c"]]),A=R,C={class:"board"};function O(e,t,r,a,s,i){const n=(0,o.up)("Tile");return(0,o.wg)(),(0,o.iD)("div",C,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.board,((e,t)=>((0,o.wg)(),(0,o.iD)("div",{key:t,class:"row"},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e,((e,r)=>((0,o.wg)(),(0,o.j4)(n,{key:t+r,value:e.value},null,8,["value"])))),128))])))),128))])}function _(e,t,r,a,s,i){return(0,o.wg)(),(0,o.iD)("div",{class:"tile",style:(0,n.j5)(i.backgroundStyle)},(0,n.zw)(i.getValue),5)}const F={0:"#373737",2:"#7504C2",4:"#F3135C",8:"#FFCB17",16:"#00C418",32:"#551584",64:"#D0007A",128:"#FF5518",256:"#29D7A4",512:"#0A96D3",1024:"#FF0024",2048:"#5F079B"},M={props:{value:{type:Number,default:0}},computed:{backgroundStyle(){return{"background-color":F[this.value]}},getValue(){return this.value?this.value:""}}},j=(0,k.Z)(M,[["render",_],["__scopeId","data-v-d823c6dc"]]),x=j,I={components:{Tile:x},props:{board:{type:Array}}},E=(0,k.Z)(I,[["render",O],["__scopeId","data-v-ae0cf920"]]),P=E;class N{constructor(e){this.maxMergedTilePoint=0,this.totalScore=0,this.storage=e,this.bestScore=e.get("2048")||0}moveRight(e){return this.moveBoard(e)}moveUp(e){let t=this.rotateToRight(e);return t=this.moveBoard(t),this.rotateToRight(t,3)}moveLeft(e){let t=this.rotateToRight(e,2);return t=this.moveBoard(t),this.rotateToRight(t,2)}moveDown(e){let t=this.rotateToRight(e,3);return t=this.moveBoard(t),this.rotateToRight(t,1)}moveBoard(e){const t=e.map((e=>this.processRow(e)));return t}processRow(e){let t=this.slideToRightRow(e);return t=this.merge(t),this.slideToRightRow(t)}addATile(e){const t=[...e],r=Math.random()<.85,a=this.getAvailableCells(e);if(0===a.length)return!1;const o=Math.floor(Math.random()*a.length),s=a[o];return t[s.row][s.column].value=r?2:4,t}getAvailableCells(e){return e.flatMap(((e,t)=>e.reduce(((e,r,a)=>0===r.value?e.concat({row:t,column:a}):e),[])))}slideToRightRow(e){return e.reduce(((e,t)=>0===t.value?[t].concat(e):e.concat(t)),[])}areSame(e,t){return t.every(((t,r)=>t.every(((t,a)=>t.value===e[r][a].value))))}merge(e){const t=[...e];for(let r=t.length-1;r>0;r--){const e=t[r],a=t[r-1];if(a.value===e.value){const t=e.value+a.value;this.totalScore+=t,t>this.maxMergedTilePoint&&(this.maxMergedTilePoint=t),e.value=t,a.value=0}}return t}generateBoard(){return[...Array(4).keys()].map((e=>[...Array(4).keys()].map((e=>({value:0})))))}rotateToRight(e,t){const r=(e,t)=>{if("undefined"===typeof t||0===t)return e;const a=this.generateBoard();for(let r=e.length-1;r>=0;r--)for(let t=e[r].length-1;t>=0;t--)a[r][e.length-1-t]=e[t][r];return r(a,t-1)};return r(e,t||1)}copyBoard(e){return e.map((e=>e.map((e=>Object.assign({},e)))))}canMove(e){for(let t=0;t<e.length;t++)for(let r=0;r<e[t].length;r++)if(0===e[t][r].value||r<e[r].length-1&&e[t][r].value===e[t][r+1].value||t<e[t].length-1&&e[t][r].value===e[t+1][r].value)return!0;return!1}saveScore(){this.storage.set("2048",this.totalScore)}}class Z{set(e,t){localStorage.setItem(e,JSON.stringify({value:t}))}get(e){const t=localStorage.getItem(e)||"{}";return JSON.parse(t).value}}const z={components:{HeadBoard:A,Board:P},data(){const e=new N(new Z);return{board:e.generateBoard(),gameStatus:"notStarted",gameService:e,message:""}},methods:{clickButton(){"notStarted"===this.gameStatus?(document.addEventListener("keydown",this.handleKeyDown),this.board=this.gameService.addATile(this.board),this.board=this.gameService.addATile(this.board),this.gameStatus="playing"):"playing"===this.gameStatus&&(this.board=this.gameService.generateBoard(),this.gameService.maxMergedTilePoint=0,this.gameService.totalScore=0,this.board=this.gameService.addATile(this.board),this.board=this.gameService.addATile(this.board))},handleKeyDown(e){const t=e.code.replace("Arrow","").toLowerCase(),r=this.gameService.copyBoard(this.board);let a;switch(t){case"right":a=this.gameService.moveRight(this.board);break;case"up":a=this.gameService.moveUp(this.board);break;case"left":a=this.gameService.moveLeft(this.board);break;case"down":a=this.gameService.moveDown(this.board);break;default:break}a&&!this.gameService.areSame(r,a)&&(this.board=this.gameService.addATile(a),this.gameService.canMove(this.board)||(this.gameService.saveScore(),this.message=`GAME OVER. Your score: ${this.gameService.totalScore}`))}},computed:{target(){return this.gameService.targetPoint}},destroyed(){document.removeEventListener("keydown",this.handleKeyDown),clearTimeout(this.setTimeoutId)},watch:{target(){this.message=`Your new target ${this.target}`,clearTimeout(this.setTimeoutId),setTimeoutId=setTimeout((()=>{this.message=""}),5e3)}}},K=(0,k.Z)(z,[["render",u]]),L=K,W={name:"app",components:{Game:L}},H=(0,k.Z)(W,[["render",i]]),Y=H;(0,a.ri)(Y).mount("#app")}},t={};function r(a){var o=t[a];if(void 0!==o)return o.exports;var s=t[a]={exports:{}};return e[a](s,s.exports,r),s.exports}r.m=e,(()=>{var e=[];r.O=(t,a,o,s)=>{if(!a){var i=1/0;for(u=0;u<e.length;u++){for(var[a,o,s]=e[u],n=!0,c=0;c<a.length;c++)(!1&s||i>=s)&&Object.keys(r.O).every((e=>r.O[e](a[c])))?a.splice(c--,1):(n=!1,s<i&&(i=s));if(n){e.splice(u--,1);var l=o();void 0!==l&&(t=l)}}return t}s=s||0;for(var u=e.length;u>0&&e[u-1][2]>s;u--)e[u]=e[u-1];e[u]=[a,o,s]}})(),(()=>{r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}})(),(()=>{r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e={143:0};r.O.j=t=>0===e[t];var t=(t,a)=>{var o,s,[i,n,c]=a,l=0;if(i.some((t=>0!==e[t]))){for(o in n)r.o(n,o)&&(r.m[o]=n[o]);if(c)var u=c(r)}for(t&&t(a);l<i.length;l++)s=i[l],r.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return r.O(u)},a=self["webpackChunk_2048"]=self["webpackChunk_2048"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var a=r.O(void 0,[998],(()=>r(824)));a=r.O(a)})();
//# sourceMappingURL=app.0f194b30.js.map